---
title: 类除了实例化还能怎么用？
date: 2023-11-16 +0800
categories: [Python]
tags: [python, oop]
---

大部分情况下，创建类就是为了实例化。但在有的情况下，我想要创建与类自身有关的变量和方法，比如说 Student 类的学生人数，新加一名学生，这样的变量和方法就叫类变量和类方法。

## 类变量

这是一个类变量的例子，在这个例子中，类变量表示学生的数量，每次实例化的时候数量也会跟着变化。

```python
class Student:
    student_num = 0

    def __init__(self, first_name, last_name):
        self.first_name = first_name
        self.last_name = last_name

        Student.student_num += 1

stu1 = Student('John', 'Smith')
```

访问类变量时，可以通过类名 `Student.std_cnt` ，也可以通过实例名 `stu1.std_cnt` 。但其中的原理是，查找到 `stu1` 实例没有 `std_cnt` 这个变量，于是从它的类中去获取。

因此，如果定义了实例的变量，就无法再通过实例访问类变量。请看下面的例子。

```python
print(stu1.std_cnt) # 1

# 此时定义了实例的变量，再从实例访问时就访问到实例变量，而不是类变量
stu1.std_cnt = 2
print(stu1.std_cnt) # 2

# 真正的类变量需要通过类名访问
print(Student.std_cnt) # 1
```

## 类方法

类方法不需要进行实例化就能使用，需要使用修饰符 `@classmethod` 进行修饰。对于这样的方法，第一个参数总是 `cls` ，指类自身。如果需要用类里面的变量或方法，需要通过 `cls` 。

延续之前的 `Student` 类，使用一个类方法定义新加入学生的动作。

```python
class Student:
    student_num = 0

    def __init__(self, first_name, last_name):
        self.first_name = first_name
        self.last_name = last_name

        Student.student_num += 1

    @classmethod
    def add_new_student(cls):
        cls.student_num += 1
```

### 如何使用类方法替代构造方法

类方法可以用来替代构造方法，尤其是在构造方法所需要的参数与传入的参数不同时最有用。下面的例子中传入的是一整个名字的字符串，但是构造函数需要的分开的 firstname 和 lastname。

```python
class Student:
    student_num = 0

    def __init__(self, first_name, last_name):
        self.first_name = first_name
        self.last_name = last_name

        Student.student_num += 1

    @classmethod
    def add_new_student(cls, name):
        cls.student_num += 1
				return cls(*name.split(' '))
```

## 类的静态方法

类的静态方法与类方法相似，都不需要实例化就能使用。但静态方法由 `@staticmethod` 装饰，不会传入参数 `cls` 或 `self`，也不能访问类属性和类方法。简单来说，静态方法和类的关系就像养子和养父养母的关系，在一起但没有血缘关系。

```python
@staticmethod
def is_full_name(name):
    return len(name.split(' ')) > 1
```