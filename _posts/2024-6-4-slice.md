---
title: "Slice：被低估的小技巧，大大提升可读性"
date: 2024-6-4 17:00:00 +0800
categories: [Python Features]
tags: [Python]
---

今天分享一个关于切片的简单技巧。

先来看一个例子。

```python
receipt_text = """
物品1: 苹果  数量: 5   单价: 3.00元
物品2: 香蕉  数量: 10  单价: 2.00元
物品3: 橙子  数量: 3   单价: 5.00元
"""

for line in receipt_text.split('\n')[1:-1]:
    print(f'item: {line[5:7]}, price: {line[20:25]}')
```

这是一个收据的文本，需求是提取出各行的物品和价格，我们可能会这样写，获取每行 5 到 7 和 20 到 25 的切片。

但这样写存在一个问题，它的可读性不太好。其他人不理解这几个数字的含义，就连你自己，也可能会在写完这段代码的几天后忘记。

为了解决这个问题，我们可以使用 slice 对象来存储切片。

```python
receipt_text = """
物品1: 苹果  数量: 5   单价: 3.00元
物品2: 香蕉  数量: 10  单价: 2.00元
物品3: 橙子  数量: 3   单价: 5.00元
"""

item_slice = slice(5, 7)
price_slice = slice(20, 25)

for line in receipt_text.split('\n')[1:-1]:
    print(f'item: {line[item_slice]}, price: {line[price_slice]}')
```

我们可以使用 `item_slice` 变量来存放索引 5 到 7 的切片，具体方式是，使用 slice 关键字，然后传入对应的索引。 `price_slice` 变量存放索引 20 到 25 的切片。

再将原本数字的位置改为这两个 slice。

可读性显然有所提升。

slice 的使用基本和我们平时使用数字切片一致，唯一的不同在于，当我们数字切片可以不填的地方，使用 slice 需要填入 None。

比如说当我想要表示从索引为 5 开始切到最后一个，按照数字切片的习惯可能就是 `[5:]`，不能只写 ` slice(5) `，不然切出来的是前五个元素。因为 slice 的传参机制是，传入一个参数时是 end，两个参数是 start 和 end，三个参数是 start, end, step。

所以正确的写法应该是 5 和 None。我们来新建一个字符串看看。

```python
my_str = 'hello, world!'
slice1 = slice(5, None)
print(my_str[slice1])
```

同样，如果我想以 step 为 2 进行切片，应该传入 None, None, 2。

```python
slice2 = slice(None, None, 2)
print(my_str[slice2])
```

这是一个很简单技巧，但可以显著提高代码的可读性。你可以在你的代码中试试看！